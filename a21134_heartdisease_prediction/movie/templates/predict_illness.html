<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ML predict heart-disease</title>

    <!-- Bootstrap core CSS -->
    <style type="text/css">
#tbl_div div {
  visibility:hidden;
    display:none;
}

div[name*="title"] {
/*  background: #ffff00;*/
  font-weight: bold;
  font-size: 150%;
  text-align: center;
}

div[class*="release_year"] {
/*  background: #ffff00;*/
  color:blue;
  font-weight: bold;
  font-size: 90%;
  text-align: center;
}



    </style>
    <link rel='stylesheet' href='/static/bootstrap-4.5.2-dist/css/bootstrap.min.css'>
    <script src="/static/d3.v3.min.js"></script>
    <script src="/static/jquery-3.5.1.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>

<bddy>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">

  <button class="navbar-toggler" type="button" data-toggle="collapse" 
  data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">

     <a class="nav-link" href="/home/1">Home <span class="sr-only">(current)</span></a>


      </li>

      <li class="nav-item active">
        <form class="form-inline my-2 my-lg-0 navbar-right" action="/home" method="POST">

                <div class="form-group">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="text" name="keyword" placeholder="search" class="form-control" autofocus>&nbsp;
                </div>
          
              <input type="submit" value="Search" class="btn btn-success">
        </form>
      </li>

      <li class="nav-item active">

      </li>


    </ul>

  </div>
</nav>


<h1>Heart disease prediction based on indicators</h1>
<!-- HTML表单 age,sex,cp,trestbps,chol,fbs,restecg,thalach,exang,oldpeak,slope,ca,thal,target  -->
<form action="/predict_illness" method="POST">

  

<table style='table-layout:fixed;'  class="StandardTable" cellpadding="0" cellspacing="0" width="80%" border="1">


    <tbody>
          
        <tr>


            <td>     <label>age</label>
    <input type="text" name="age">
           </td>

           <td>
                 <label>sex</label>
    <input type="text" name="sex">
           </td>

        </tr>
        <tr>


            <td>         <label>cp</label>
    <input type="text" name="cp">
           </td>
           
           <td>
                     <label>trestbps</label>
    <input type="text" name="trestbps">
           </td>

        </tr>

        <tr>


            <td>         <label>chol</label>
    <input type="text" name="chol">
           </td>
           
           <td>
                      <label>fbs</label>
    <input type="text" name="fbs">
           </td>

        </tr>

        <tr>
        <td>   
 <label>restecg</label>
    <input type="text" name="restecg">
           </td>
           
           <td>
                     <label>thalach</label>
    <input type="text" name="thalach">
           </td>

        </tr>

        <tr>
              <td>   
 <label>exang</label>
    <input type="text" name="exang">
           </td>
           
           <td>
                 <label>oldpeak</label>
    <input type="text" name="oldpeak">
           </td>

        </tr>
        <tr>
            <td>
    <label>slope</label>
    <input type="text" name="slope">
           </td>
           
           <td>
                    <label>ca</label>
    <input type="text" name="ca">
           </td>

        </tr>
        <tr>
            <td>
 <label>thal</label>
    <input type="text" name="thal">
           </td>
           
           <td>
                     
           </td>

        </tr>       

    </tbody>

</table>
    <br><br>
    &nbsp;&nbsp;<input type="submit" value="predict"  class="btn btn-success">


</form>


<div class="radarChart"></div>
<script src="/static/radarChart.js"></script>   

<hr/>
<br/>
<h4> based on input <label id="myparameters" name="myparameters"> {{ sample1 }} </label>. We use ML to predict as following: </h4>
<h3> predict result: <span style="background-color: yellow;">{{ r }} </span> </h3>
<script>
        // http://bl.ocks.org/chrisrzhou/2421ac6541b68c1680f8
      
      /* Radar chart design created by Nadieh Bremer - VisualCinnamon.com */
      
            ////////////////////////////////////////////////////////////// 
            //////////////////////// Set-Up ////////////////////////////// 
            ////////////////////////////////////////////////////////////// 

            var margin = {top: 100, right: 100, bottom: 100, left: 100},
                width = Math.min(700, window.innerWidth - 10) - margin.left - margin.right,
                height = Math.min(width, window.innerHeight - margin.top - margin.bottom - 20);
                    
            ////////////////////////////////////////////////////////////// 
            ////////////////////////// Data ////////////////////////////// 
            ////////////////////////////////////////////////////////////// 
            // age,sex,cp,trestbps,chol,fbs,restecg,thalach,exang,oldpeak,slope,ca,thal

            var myparameters = $("#myparameters").text().replaceAll('[', '').replaceAll(']', '').replaceAll("'", "");
            myparameters = myparameters.split(/[, ]+/);

            console.log('1 myparameters=',myparameters)
            for(var i=0, len=myparameters.length; i < len; i++)
            {
                myparameters[i] = parseInt(myparameters[i]);
                console.log(myparameters[i]);
            }
            myparameters.filter(Number);
            myparameters = myparameters.filter(function (value) {
                return !Number.isNaN(value);
            });
            console.log('2 myparameters=',myparameters)
            var data = [
                      [//iPhone
                        {axis:"age",value:myparameters[0]},
                        {axis:"sex",value:myparameters[1]},
                        {axis:"cp",value:myparameters[2]},
                        {axis:"trestbps",value:myparameters[3]},
                        {axis:"chol",value:myparameters[4]},
                        {axis:"fbs",value:myparameters[5]},
                        {axis:"restecg",value:myparameters[6]},
                        {axis:"thalach",value:myparameters[7]},     
                        {axis:"exang",value:myparameters[8]},     
                        {axis:"oldpeak",value:myparameters[9]},     
                        {axis:"slope",value:myparameters[10]},     
                        {axis:"ca",value:myparameters[11]},     
                        {axis:"thal",value:myparameters[12]}   
                      ]
                    ];
            // var data = [
            //           [//iPhone
            //             {axis:"age",value:0.22},
            //             {axis:"sex",value:0.28},
            //             {axis:"cp",value:0.29},
            //             {axis:"trestbps",value:0.17},
            //             {axis:"chol",value:0.22},
            //             {axis:"fbs",value:0.02},
            //             {axis:"restecg",value:0.21},
            //             {axis:"thalach",value:0.50},     
            //             {axis:"exang",value:0.50},     
            //             {axis:"oldpeak",value:0.50},     
            //             {axis:"slope",value:0.50},     
            //             {axis:"ca",value:0.50},     
            //             {axis:"thal",value:0.50}   
            //           ]
            //         ];
            ////////////////////////////////////////////////////////////// 
            //////////////////// Draw the Chart ////////////////////////// 
            ////////////////////////////////////////////////////////////// 

            var color = d3.scale.ordinal()
                .range(["#EDC951","#CC333F","#00A0B0"]);
                
            var radarChartOptions = {
              w: width,
              h: height,
              margin: margin,
              maxValue: 0.5,
              levels: 5,
              roundStrokes: true,
              color: color
            };
            //Call function to draw the Radar chart
            RadarChart(".radarChart", data, radarChartOptions);
        </script>
